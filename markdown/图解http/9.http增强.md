## 9.http增强

**HTTP 的瓶颈**

若想在现有 Web 实现所需的功能，以下这些 HTTP 标准就会成为瓶颈。

-   **一条连接上只可发送一个请求。**

-   **请求只能从客户端开始。客户端不可以接收除响应以外的指令。**

-   **请求 / 响应首部未经压缩就发送。首部信息越多延迟越大。**

-   **发送冗长的首部。每次互相发送相同的首部造成的浪费较多。**

-   **可任意选择数据压缩格式。非强制压缩发送。**

    ​

![avatar](/img/15.jpeg)**图：以前的 HTTP 通信**



![avatar](/img/16.jpeg)**图：Ajax 通信**



![avatar](/img/17.jpeg)**图：Comet 通信**



#### SPDY 

使用 SPDY 后，HTTP 协议额外获得以下功能。

SPDY 以会话层的形式加入，控制对数据的流动，但还是采用 HTTP 建立通信连接。因此，可照常使用 HTTP 的 GET 和 POST 等方 法、Cookie 以及 HTTP 报文等。

SPDY 基本上只是将单个域名（ IP 地址）的通信多路复用，所以当一个 Web 网站上使用多个域名下的资源，改善效果就会受到限制。

**多路复用流**

通过单一的 TCP 连接，可以无限制处理多个 HTTP 请求。所有请求的处理都在一条 TCP 连接上完成，因此 TCP 的处理效率得到提高。

**赋予请求优先级**

SPDY 不仅可以无限制地并发处理请求，还可以给请求逐个分配优先级顺序。这样主要是为了在发送多个请求时，解决因带宽低而导致响应变慢的问题。

**压缩 HTTP 首部**

压缩 HTTP 请求和响应的首部。这样一来，通信产生的数据包数量和发送的字节数就更少了。

**推送功能**

支持服务器主动向客户端推送数据的功能。这样，服务器可直接发送数据，而不必等待客户端的请求。

**服务器提示功能**

服务器可以主动提示客户端请求所需的资源。由于在客户端发现资源之前就可以获知资源的存在，因此在资源已缓存等情况下，可以避免发送不必要的请求。



#### WebSocket 

WebSocket，即 Web 浏览器与 Web 服务器之间全双工通信标准

只要建立起 WebSocket 连接，就希望一直保持连接状态。和 HTTP 相比，不但每次连接时的总开销减少，而且由于 WebSocket 的首部信息很小，通信量也相应减少了。

wos握手秦秋

**websocket协议**
一旦 Web 服务器与客户端之间建立起 WebSocket 协议的通信连接，之后所有的通信都依靠这个专用协议进行。通信过程中可互相发送 JSON、XML、HTML 或图片等任意格式的数据。

![avatar](/img/18.jpeg)